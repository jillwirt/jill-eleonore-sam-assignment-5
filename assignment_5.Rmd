---
title: "Assignment 5"
author: "Jill Wirt"
date: "November 26, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Welcome to assignment 5!!!!!!!!

```{r, echo = FALSE, message = FALSE}
# Load packages and read in data
library(tidyverse)
library(vcdExtra)
library(car)
library(onewaytests)
library(kableExtra)
library(ggsignif)
library(effsize)
library(xtable)
library(stringr)
library(ggpubr)

faculty_salary <- read_csv("faculty_salary.csv")
# faculty_salary

grad_enrollment <- read_csv("grad_enrollment.csv")
# grad_enrollment

med_salary <- read_csv("med_salary.csv")
# med_salary

phd_by_field <- read_csv("phd_by_field.csv")
# phd_by_field

```

Part 1. Compare trends in total graduate enrollment for males and females (including full-time/part-time and private/public universities) in the U.S. from 1967-2015.
```{r}

enrollment_trend <- ggplot(grad_enrollment, aes(year)) +
  geom_line(aes(y = total_males, color = "Male"))+
  geom_line(aes(y = total_females, color = "Female")) +
  labs(x = "Year", y = "Number of Students Enrolled", caption = str_wrap("Figure 1: Enrollment trends for males and females from 1967 to 2015.")) +
  theme_classic() +
  theme(plot.caption=element_text(size=8, hjust=0, margin=margin(t=15)), text = element_text(family="Times New Roman", size=11),  legend.title=element_blank()) +
  scale_x_continuous(expand = c(0,10), breaks = c(1955, 1965, 1975, 1985, 1995, 2005, 2015)) +
  scale_y_continuous(expand = c(0, 200000), breaks = c(200000, 400000, 600000, 800000, 1000000, 1200000, 1400000, 1600000, 1800000)) +
  scale_color_manual(values=c("red", "blue"))

enrollment_trend 

# Statistical evidence with linear regression

males_lm <- lm(year ~ total_males, data = grad_enrollment)

females_lm <- lm(year ~ total_females, data = grad_enrollment)
plot(males_lm)
plot(females_lm)

regress_male <- ggplot(grad_enrollment, aes(x=year, y= total_males)) +
  geom_point()+
  geom_smooth(method= lm, se= TRUE, size= 0.5, color="gray20")



regress_female <- ggplot(grad_enrollment, aes(x=year, y= total_females)) +
  geom_point()+
  geom_smooth(method= lm, se= TRUE, size= 0.5, color="gray20")

regress_female
regress_male

#and then pearson's r
```



```{r}
# checking for normality
hist_male_enrol<-ggplot(grad_enrollment, aes(x=total_males)) +
  geom_histogram()

hist_male_enrol

qq_male_enrol <- ggplot(grad_enrollment, aes(sample=total_males)) +
  geom_qq()

qq_male_enrol

hist_female_enrol <- ggplot(grad_enrollment, aes(x=total_females)) +
  geom_histogram()

qq_female_enrol <- ggplot(grad_enrollment, aes(sample=total_females)) +
  geom_qq()

hist_female_enrol
qq_female_enrol

```

Part 2. Describe if and how there was a shift in PhDs awarded to females in four fields (Physical and Earth Sciences, Engineering, Education, and Humanities & Arts) in 1985, 2000, and 2015. 

```{r}
phd<- phd_by_field %>% 
  select(field_of_study,`1985_number`, `2000_number`, `2015_number` ) %>% 
  filter(field_of_study == "physical_earth_science_female" | field_of_study =="engineering_female" | field_of_study == "education_female" | field_of_study == "humanities_female")

```




Part 3. Compare median salaries for male and female doctorate recipients in 2015. Answer these two questions: Does median salary differ significantly between male and female starting postdoc positions? Does median salary differ significantly between male and female PhD recipients in non-postdoc employent positions?
```{r}

# Mann-Whitney U to compare medians?


```


Part 4. Explore relationships between variables in the 'Faculty salary data (2008-2009)' dataset (faculty_salary). Develop a model describing faculty salary based on data for faculty sex, rank, years in current position, field, and number of years since doctoral degree was earned. YOU should make decisions regarding which variables should remain in your final model. 




